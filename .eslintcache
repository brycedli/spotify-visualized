[{"/Users/wencheng/Documents/dev/projects/musicscape/spotify-visualized/src/App.js":"1","/Users/wencheng/Documents/dev/projects/musicscape/spotify-visualized/src/pages/Visualize.js":"2","/Users/wencheng/Documents/dev/projects/musicscape/spotify-visualized/src/pages/Login.js":"3","/Users/wencheng/Documents/dev/projects/musicscape/spotify-visualized/src/index.js":"4","/Users/wencheng/Documents/dev/projects/musicscape/spotify-visualized/src/reducers/index.js":"5","/Users/wencheng/Documents/dev/projects/musicscape/spotify-visualized/src/reducers/particles.js":"6","/Users/wencheng/Documents/dev/projects/musicscape/spotify-visualized/src/actions/index.js":"7","/Users/wencheng/Documents/dev/projects/musicscape/spotify-visualized/src/components/Welcome.js":"8","/Users/wencheng/Documents/dev/projects/musicscape/spotify-visualized/src/middleware/SpotifyApi.js":"9","/Users/wencheng/Documents/dev/projects/musicscape/spotify-visualized/src/theme.js":"10","/Users/wencheng/Documents/dev/projects/musicscape/spotify-visualized/src/pages/Home.js":"11"},{"size":1223,"mtime":1611029785662,"results":"12","hashOfConfig":"13"},{"size":8732,"mtime":1610956527627,"results":"14","hashOfConfig":"13"},{"size":1949,"mtime":1611029508739,"results":"15","hashOfConfig":"13"},{"size":439,"mtime":1611013664978,"results":"16","hashOfConfig":"13"},{"size":125,"mtime":1610954220112,"results":"17","hashOfConfig":"13"},{"size":341,"mtime":1610932354265,"results":"18","hashOfConfig":"13"},{"size":242,"mtime":1610930320534,"results":"19","hashOfConfig":"13"},{"size":2128,"mtime":1611030524387,"results":"20","hashOfConfig":"13"},{"size":715,"mtime":1611000049028,"results":"21","hashOfConfig":"13"},{"size":661,"mtime":1611017343423,"results":"22","hashOfConfig":"13"},{"size":374,"mtime":1611029041556,"results":"23","hashOfConfig":"13"},{"filePath":"24","messages":"25","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},"15gxljm",{"filePath":"26","messages":"27","errorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"28"},{"filePath":"29","messages":"30","errorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"31","messages":"32","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"33","messages":"34","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"35","messages":"36","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"37","messages":"38","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"39","messages":"40","errorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"41","messages":"42","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"43","messages":"44","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"45","messages":"46","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"47"},"/Users/wencheng/Documents/dev/projects/musicscape/spotify-visualized/src/App.js",["48"],"/Users/wencheng/Documents/dev/projects/musicscape/spotify-visualized/src/pages/Visualize.js",["49","50","51","52","53"],"import { map } from \"async\";\nimport { Component, createElement } from \"react\";\nimport * as THREE from \"three\";\nimport { connect } from 'react-redux'\nimport { addParticles } from '../actions'\nimport PropTypes from 'prop-types';\n\n\nvar accessToken;\nvar hash = {};\nvar particles = new Map();\nwindow.location.hash.replace(/^#\\/?/, '').split('&').forEach(function(kv) {\n    var spl = kv.indexOf('=');\n    if (spl !== -1) {\n        hash[kv.substring(0, spl)] = decodeURIComponent(kv.substring(spl+1));\n    }\n    \n});\nvar maxSongs = 400;\n\n// console.log('initial hash', hash);\nif (hash.access_token){\n    // initializeThree();\n    accessToken = hash.access_token;\n\n    //var url = 'https://api.spotify.com/v1/me/tracks?time_range=short_term&limit=10';\n    var url = 'https://api.spotify.com/v1/me/top/tracks?time_range=long_term&limit=10'\n    getTopSongs(url, function(){\n        getFeatures(function(){\n            console.log(\"done\", particles);\n\n        });\n    });\n\n    function getFeatures(callback){\n        function analyzeTrack(accessToken, arr) {\n            var newArr = [];\n            //GET https://api.spotify.com/v1/audio-analysis/{id}\n            arr.forEach(function (item, index, array) {\n                newArr.push(item.getTrackData().id);\n                // console.log(item.getTrackData().id); \n            });\n            var fullURL = 'https://api.spotify.com/v1/audio-features?ids=' + newArr.join(\",\");\n            // console.log(arr.join(\",\"));\n            return fetch(fullURL, {\n                method: 'GET',\n\n                headers: {\n                    'Authorization': 'Bearer ' + accessToken,\n                },\n\n            });\n\n        }\n        var mapArray = Array.from(particles.values());\n            requestTrackWrapper(0);\n            function requestTrackWrapper(index) {\n                var maxedIndex = Math.min(index + 50, mapArray.length);\n                analyzeTrack(accessToken, mapArray.slice(index, maxedIndex)).then((response) => {\n                    return response.json();\n                }).then((data) => {\n                    setTimeout(function () {\n                        // loadingText.textContent = \"analyzing \" + maxedIndex + \"/\" +  mapArray.length + ' songs...';\n                        // loadingText.style.display = 'block';\n                        console.log(\"maxed:\", maxedIndex, \"index\", index);\n                        if (data) {\n                            console.log(data);\n\n                            data.audio_features.forEach(function (item, index, array) {\n                                if (item && item.id && particles.get(item.id)){\n                                    particles.get(item.id).addFeatureData(item);\n                                }\n                            });\n                        } else {\n                            console.log(\"no data\");\n                        }\n                        if (maxedIndex < mapArray.length){\n                            requestTrackWrapper(maxedIndex);\n\n                        }else{\n                            // loadingText.style.display = 'none';\n                            callback();\n                            // console.log(\"done\");\n                            // renderData();\n                        }\n                    }, 5);\n\n                });\n            }\n    }\n    function getTopSongs(url, callback){\n        \n        fetch(url,{\n            method: 'GET',\n            headers:{\n                'Authorization' : 'Bearer ' + accessToken,\n            },\n    \n        }).then((response)=>{\n            return response.json();\n        }).then((data)=> {\n            console.log(data);\n\n            data.items.forEach(function(item, index, array) {\n                var particle = new Particle();\n                particle.addTrackData(item);\n                // console.log(item.track.name, item.track.artists[0].name);\n                if(!item){\n                    console.log(\"item not found in initial song loop\");\n                }\n\n                if (!particles.get(item.id)) {\n                    particles.set(item.id, particle);\n    \n                } else {\n                    console.log(\"Duplicate item, skipping\");\n                }\n                \n\n            })\n            console.log(data.next, data.offset);\n            //update view\n            //updateFunction\n\n            // if (maxSongs > particles.size){\n            //     getTopSongs(data.next, callback);\n\n            // }\n            if (data.next) {\n\n                getTopSongs(data.next, callback);\n            } \n            else {\n                callback();\n            }\n        });\n    }\n    \n}\nclass Particle {\n    // trackData;\n    // featureData;\n    addTrackData(trackData) {\n        this.trackData = trackData;\n    };\n\n    addFeatureData(featureData) {\n        this.featureData = featureData;\n    };\n    getTrackData(trackData) {\n        return this.trackData;\n    };\n    getFeatureData(featureData) {\n        return this.featureData;\n    };\n\n}\n\n\n\nclass ThreeJsComponent extends Component {\n\n  constructor (props){\n    super(props);\n    this.particles = [];\n  }\n  componentDidUpdate(preProp) {\n    console.log('updated');\n    this.handleUpdate();\n  }\n  renderParticle(particle){\n    //do particle addition logic here, otherwise render.\n    //1. create new sphere , set pos and size, color\n    //2. create new 3d text, set anchor,size,content\n    //3. this.renderer.add sphere and text\n    var geometry = new THREE.BoxGeometry(2, 0.5, 0.5);\n    var material = new THREE.MeshBasicMaterial({ color: 0x333300 });\n    var cube = new THREE.Mesh(geometry, material);\n    cube.position.x = Math.floor(Math.random() * 4);\n    cube.position.y = Math.floor(Math.random() * 4);\n    this.scene.add(cube);\n  }\n  \n  handleUpdate(){\n    console.log(`render particle ${this.props.particles} in Visualize`);\n    const currentState = [];\n    for (const p in this.props.particles){\n      //console.log(p);\n      this.renderParticle(p);\n      this.particles.push(p);\n    }\n    \n    this.renderer.render(this.scene, this.camera);\n    console.log('rendered', this.particles);\n    //somehow add orbit control js, which allow drag to rotate camera\n    //https://github.com/brycedli/spotify-visualized/blob/aa9485c2b8b2a4f60869ac57ae89cd051da053bb/django-spotify/spotme/templates/spotme/visualize.html#L470\n    console.log(\"rendered\");\n  }\n  \n  // return <h1>Hello</h1>;\n  componentDidMount(){\n      this.scene = new THREE.Scene();\n      this.camera = new THREE.PerspectiveCamera(\n      75,\n      window.innerWidth / window.innerHeight,\n      0.1,\n      1000\n      );\n\n      this.renderer = new THREE.WebGLRenderer();\n      this.renderer.setSize(window.innerWidth, window.innerHeight);\n      console.log(this.mount);\n      this.mount.appendChild(this.renderer.domElement);\n\n      var geometry = new THREE.BoxGeometry(1, 1, 1);\n      var material = new THREE.MeshBasicMaterial({ color: 0x00ff00 });\n      var cube = new THREE.Mesh(geometry, material);\n      this.scene.add(cube);\n\n      this.camera.position.z = 5;\n\n      this.renderer.render(this.scene, this.camera);\n      var _renderer = this.renderer;\n      var _scene = this.scene;\n      var _camera = this.camera;\n      var animate = function () {\n        requestAnimationFrame( animate );\n        cube.rotation.x += 0.01;\n        cube.rotation.y += 0.01;\n        _renderer.render( _scene, _camera );\n      };\n      animate();\n  }\n\n  render(){\n    return (\n      <div>\n        <p>\n            Visualize stuff here\n        </p>\n        <p>\n          {/* particles: {this.props.particle} */}\n        </p>\n        {/* <ul>\n          {this.props.particles.map(p => (\n          <li>{p}</li>\n          ))}\n        </ul> */}\n        <div \n            style={{ width: \"800px\", height: \"800px\" }}\n            ref={mount => { this.mount = mount}}\n        />\n      </div>\n    )\n  }\n}\n// console.log(\"creating component\")\n// const objType = createElement(ThreeJsComponent,{ name:\"nnamdi\" });\n// objType.handleUpdate();\n// var threeCompRef;\n// export default function VisualizePage(){\n//     return(\n//         <div>\n//             <p>\n//                 Visualize stuff here\n//             </p>\n//             <ThreeJsComponent/>\n//             {/* <ThreeJsComponent ref={this.threeCompRef}/> */}\n//         </div>\n//     )\n// }\n\n\nconst mapStateToProps = (state) => {\n  console.log(state.particles);\n  return {\n    particles: state.particles\n  };\n}\n\n// const mapDispatchToProps = dispatch => {\n//   console.log('mapDispatchToProps called');\n//   return {\n//     particles: partical => dispatch(partical)\n//   };\n// }\n\nThreeJsComponent.propTypes = {\n  particles: PropTypes.array\n}\n\n\n\nexport default connect(mapStateToProps /*,mapDispatchToProps*/)(ThreeJsComponent) \n","/Users/wencheng/Documents/dev/projects/musicscape/spotify-visualized/src/pages/Login.js",["54","55","56","57","58","59","60","61"],"/Users/wencheng/Documents/dev/projects/musicscape/spotify-visualized/src/index.js",[],"/Users/wencheng/Documents/dev/projects/musicscape/spotify-visualized/src/reducers/index.js",[],"/Users/wencheng/Documents/dev/projects/musicscape/spotify-visualized/src/reducers/particles.js",[],"/Users/wencheng/Documents/dev/projects/musicscape/spotify-visualized/src/actions/index.js",[],"/Users/wencheng/Documents/dev/projects/musicscape/spotify-visualized/src/components/Welcome.js",["62","63","64","65"],"/Users/wencheng/Documents/dev/projects/musicscape/spotify-visualized/src/middleware/SpotifyApi.js",[],"/Users/wencheng/Documents/dev/projects/musicscape/spotify-visualized/src/theme.js",["66"],"/Users/wencheng/Documents/dev/projects/musicscape/spotify-visualized/src/pages/Home.js",["67","68"],"import { map } from \"async\";\nimport { Component, createElement } from \"react\";\nimport { connect } from 'react-redux'\nimport Welcome from '../components/Welcome'\n\nclass Home extends Component {\n\n  render(){\n    return (\n        <Welcome />\n    )\n  }\n}\nconst mapStateToProps = (state, ownProps) => ({\n  session: state.session\n})\n\nexport default connect(mapStateToProps)(Home) ",{"ruleId":"69","severity":1,"message":"70","line":6,"column":3,"nodeType":"71","messageId":"72","endLine":6,"endColumn":7},{"ruleId":"69","severity":1,"message":"73","line":1,"column":10,"nodeType":"71","messageId":"72","endLine":1,"endColumn":13},{"ruleId":"69","severity":1,"message":"74","line":2,"column":21,"nodeType":"71","messageId":"72","endLine":2,"endColumn":34},{"ruleId":"69","severity":1,"message":"75","line":5,"column":10,"nodeType":"71","messageId":"72","endLine":5,"endColumn":22},{"ruleId":"69","severity":1,"message":"76","line":19,"column":5,"nodeType":"71","messageId":"72","endLine":19,"endColumn":13},{"ruleId":"69","severity":1,"message":"77","line":186,"column":11,"nodeType":"71","messageId":"72","endLine":186,"endColumn":23},{"ruleId":"69","severity":1,"message":"73","line":1,"column":10,"nodeType":"71","messageId":"72","endLine":1,"endColumn":13},{"ruleId":"69","severity":1,"message":"74","line":2,"column":21,"nodeType":"71","messageId":"72","endLine":2,"endColumn":34},{"ruleId":"69","severity":1,"message":"78","line":3,"column":8,"nodeType":"71","messageId":"72","endLine":3,"endColumn":17},{"ruleId":"69","severity":1,"message":"79","line":22,"column":10,"nodeType":"71","messageId":"72","endLine":22,"endColumn":22},{"ruleId":"80","severity":1,"message":"81","line":57,"column":12,"nodeType":"82","endLine":59,"endColumn":14},{"ruleId":"80","severity":1,"message":"81","line":59,"column":40,"nodeType":"82","endLine":61,"endColumn":12},{"ruleId":"80","severity":1,"message":"81","line":61,"column":21,"nodeType":"82","endLine":62,"endColumn":12},{"ruleId":"80","severity":1,"message":"81","line":62,"column":40,"nodeType":"82","endLine":64,"endColumn":12},{"ruleId":"69","severity":1,"message":"83","line":7,"column":9,"nodeType":"71","messageId":"72","endLine":7,"endColumn":23},{"ruleId":"69","severity":1,"message":"84","line":7,"column":25,"nodeType":"71","messageId":"72","endLine":7,"endColumn":44},{"ruleId":"69","severity":1,"message":"85","line":21,"column":9,"nodeType":"71","messageId":"72","endLine":21,"endColumn":16},{"ruleId":"69","severity":1,"message":"86","line":22,"column":9,"nodeType":"71","messageId":"72","endLine":22,"endColumn":16},{"ruleId":"69","severity":1,"message":"87","line":2,"column":9,"nodeType":"71","messageId":"72","endLine":2,"endColumn":13},{"ruleId":"69","severity":1,"message":"73","line":1,"column":10,"nodeType":"71","messageId":"72","endLine":1,"endColumn":13},{"ruleId":"69","severity":1,"message":"74","line":2,"column":21,"nodeType":"71","messageId":"72","endLine":2,"endColumn":34},"no-unused-vars","'Link' is defined but never used.","Identifier","unusedVar","'map' is defined but never used.","'createElement' is defined but never used.","'addParticles' is defined but never used.","'maxSongs' is assigned a value but never used.","'currentState' is assigned a value but never used.","'PropTypes' is defined but never used.","'testParticle' is defined but never used.","react/jsx-no-comment-textnodes","Comments inside children section of tag should be placed inside braces","Literal","'CONNECTION_URL' is defined but never used.","'authenticateSpotify' is defined but never used.","'classes' is assigned a value but never used.","'history' is assigned a value but never used.","'grey' is defined but never used."]